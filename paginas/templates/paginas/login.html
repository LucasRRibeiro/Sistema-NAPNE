{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<link rel="shortcut icon" type="image/png" href="{% static 'img/Icone-site.png' %}">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> {% block titulo %} <title>CNAPNE - IFPR</title>
  {% endblock %}
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/ifpr.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>

<body class="d-flex flex-column min-vh-100">

  <!-- Cabeçalho institucional -->
  <header style="background-color: rgb(252, 255, 223);" class="py-2 px-4 border-bottom">
    {% if user.is_authenticated %}
      <a href="{% url 'tela-inicio' %}"><img src="{% static 'img/reitoria-horizontal-1.png' %}" alt="Logo IFPR" height="60"></a>
    {% else %}
      <a href="{% url 'index' %}"><img src="{% static 'img/reitoria-horizontal-1.png' %}" alt="Logo IFPR" height="60"></a>
    {% endif %}
  </header>

  <!-- Conteúdo principal -->
  <main class="{% if user.is_authenticated %}container-fluid d-flex align-items-center justify-content-center flex-grow-1{% else %}container my-5 flex-grow-1{% endif %}">

    <div class="row align-items-center {% if user.is_authenticated %}w-100{% endif %}">

      {% if not user.is_authenticated %}
      <div class="col-md-6 text-center mb-4 mb-md-0 d-flex overflow: hidden; justify-content-start">
        <img src="{% static 'img/logo_napne.png' %}" alt="Logo NAPNE" class="img-fluid fade-in" id="logo-fade"
          style="max-height: 800px; width: auto; margin-left: -250px;">
      </div>
      {% endif %}

      <div class="{% if user.is_authenticated %}col-12{% else %}col-md-6{% endif %}">
        <div id="conteudo-fade" class="fade-in">
          {% block conteudo %}
          
          {% if user.is_authenticated %}
          <!-- Mensagem para usuário já logado sem permissão -->
          <div class="col-12 d-flex justify-content-center">
            <div style="max-width: 500px; width: 100%;">
              <div class="card shadow-lg border-0">
                <div class="card-body text-center p-4" style="background: linear-gradient(135deg, #dc3545, #c82333); border-radius: 0.5rem;">
                  <h3 class="text-white mb-3" style="font-size: 1.8rem; font-weight: bold;">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>Ação não permitida
                  </h3>
                  <hr class="border-white my-3 mx-4" style="opacity: 0.7;">
                  <p class="text-white mb-0" style="font-size: 1.1rem;">
                    Houve algum problema para processar a ação desejada ou você não tem permissão para isso.
                  </p>
                </div>
              </div>
              
              <div class="text-center mt-4">
                <a href="{% url 'tela-inicio' %}" class="btn btn-success btn-lg me-3">
                  <i class="bi bi-house-fill me-2"></i>Voltar ao Início
                </a>
                <a href="{% url 'logout' %}" class="btn btn-outline-danger btn-lg">
                  <i class="bi bi-box-arrow-right me-2"></i>Sair da Conta
                </a>
              </div>
            </div>
          </div>
          
          {% else %}
          <!-- Formulário de login padrão -->
          <div class="form-container login" id="form-login">

            <div class="conteudo-esquerda px-4">
              <img src="{% static 'img/marca-cnapne_horizontal-1.png' %}" alt="Logo CNAPNE" class="img-fluid mb-4">
            </div>

            <form method="POST" action="">
              {% csrf_token %} {{ form.as_p }}
              <!-- Botão do olhinho -->
              <!-- Botão do olhinho (vai ser posicionado dentro do campo via CSS) -->
              <button type="button" id="toggle-password" class="toggle-password">
                <i class="bi bi-eye"></i>
              </button>
              <p class="text-right mt-2 fade-in" id="mensagem-cadastro" style="font-size: 1.0rem;">
                Não tem conta? <a href="{% url 'registrar' %}">Clique aqui </a></p>
              <button type="submit">Entrar</button>
            </form>
          </div>
          {% endif %}
          
        </div>
      </div>
      {% endblock %}

  </main>

  <!-- Rodapé institucional -->
  <footer class="text-center text-muted py-3 mt-auto">
    <p class="mb-0"><strong>© 2025 Lucas Rodrigues e Guilherme Ambrozim | Todos os direitos reservados</strong></p>
  </footer>

  <!-- Scripts -->
  <script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
  <script src="{% static 'js/popper.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script> {% block scripts %} {% endblock %}
</body>

<div vw class="enabled">
  <div vw-access-button class="active"></div>
  <div vw-plugin-wrapper>
    <div class="vw-plugin-top-wrapper"></div>
  </div>
</div>

<script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
<script> new window.VLibras.Widget('https://vlibras.gov.br/app'); </script>


<!-- Scripts -->
<script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
<script src="{% static 'js/popper.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>

<script>
  // Formulário
  const conteudo = document.getElementById('conteudo-fade');
  setTimeout(() => {
    conteudo.classList.add('visible');
  }, 100);

  // Logo (apenas se existir)
  const logo = document.getElementById('logo-fade');
  if (logo) {
    setTimeout(() => {
      logo.classList.add('visible');
    }, 300); // atraso ligeiro para um efeito em cascata
  }

  // Mensagem de cadastro (apenas se existir)
  const mensagem = document.getElementById('mensagem-cadastro');
  if (mensagem) {
    setTimeout(() => {
      mensagem.classList.add('visible');
    }, 500); // aparece depois do formulário e da logo
  }
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggleBtn = document.getElementById("toggle-password");
    const passwordField = document.getElementById("id_password");
    const icon = toggleBtn ? toggleBtn.querySelector("i") : null;

    if (passwordField && toggleBtn && icon) {
      toggleBtn.addEventListener("click", () => {
        if (passwordField.type === "password") {
          passwordField.type = "text";
          icon.classList.remove("bi-eye");
          icon.classList.add("bi-eye-slash");
        } else {
          passwordField.type = "password";
          icon.classList.remove("bi-eye-slash");
          icon.classList.add("bi-eye");
        }
      });
    }
  });
</script>

</html>